# 第 3 章 进程、线程的对比

## 问题

- 进程中都封装了哪些资源？
- Linux 中进程和线程的联系和区别究竟有哪些？
- 内核任务如 ksoftirqo 应该被称为内核进程还是内核线程？
- 内核在保存使用的 PID 号时是如何优化内存占用的？
- 分配 PID 时，为何每个命名空间都需要分配 PID？
- PID 的最大值是多少？
- 为何 Linux 内核中将 PID 存储从 bitmap 改成了基数树（Radix Tree）？

## 总结

- 分配 PID 时，为何每个命名空间都需要分配 PID？

    答：使用 PID 命名空间时，每个命名空间中的 PID 都可以从 1 开始；父级的命名空间可以看到/管理所有子级命名空间的进程，因此需要同时给子级和父级都分配 PID，并且两个 PID 大概率不相同。

- PID 的最大值是多少？

    答：PID 的最大值可以人为调整；Linux 内核也可能根据 CPU 数量进行动态调整；理论最大值在 Linux 2.6.24 从 2^15（32768）调整到了 2^22 (4194304)。可以通过 `cat /proc/sys/kernel/pid_max` 看到最大值。

