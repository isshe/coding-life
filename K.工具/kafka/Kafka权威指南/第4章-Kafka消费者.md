[TOC]

第四章 Kafka 消费者——从 Kafka 读取数据
---

# 概念
* 消费者：从 Kafka 中读取数据。
* 消费者群组：一个群组里的消费者订阅的是同一主题，每个消费者接收主题一部分分区的消息。
* 再均衡：分区的所有权从一个消费者转移到另一个消费者。
  * 再均衡期间消费者无法读取消息，因此整个群组会有小段时间不可用！
* 独立消费者：没有群组的消费者。
* `提交(commit)`: 更新分区当前位置的操作。
* 偏移量：消息在分区里的位置。

# 分区的分配过程？
* 当消费者加入群组时，它会向`群组协调器`发送一个`JoinGroup`请求。
* 第一个加入群组的消费成成为`群主`。负责从协调器获取群组成员列表，并给每一个消费者分配分区。

# 什么时候会进行再均衡？
* 消费者死亡的时候。
* 添加/删除消费者的时候。

# 如何安全的再均衡？

# 如何避免不必要的再均衡？

# 为什么使用独立消费者？
* 当只需要一个消费者从一个主题的所有分区或者特定分区读取数据时，就不需要消费者群组和再均衡了。


# 如何使用独立消费者？
* 直接为自己分配分区。

# 消费者是如何管理偏移量的？
* 自动提交偏移量：`enable.auto.commit`、`auto.commit.interval.ms`。
* 提交当前偏移量：同步提交 (`commitSync()`)、异步提交 (`comimtAsync()`)、同步异步组合提交。