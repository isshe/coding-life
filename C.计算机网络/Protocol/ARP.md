ARP 协议
---

ARP（Address Resolution Protocol）：地址解析协议，是根据 IP 地址获取物理地址的一个 TCP/IP 协议。

# 工作过程
当主机 A 要与主机 B 通信时，地址解析协议可以将主机 B 的 IP 地址解析成主机 B 的 MAC 地址 (如果 A/B 不同网段，则 A 解析的应该是下一跳的 MAC 地址)，以下为工作流程：
* 第 1 步：主机 A 根据路由表内容，确定用于访问主机 B 的转发 IP 地址。主机 A 在本地 ARP 缓存中查找与主机 B 的 IP 匹配 MAC 地址。
* 第 2 步：如果主机 A 没有找到映射，则将 ARP 请求帧广播到本地网络上的所有主机。
    * 收到请求的主机检查自己的 IP 是否匹配，不匹配就丢弃此 ARP 请求。
* 第 3 步：主机 B 确定 ARP 请求中的 IP 地址与自己的 IP 地址匹配，则将主机 A 的 IP 地址和 MAC 地址映射添加到本地 ARP 缓存中。
* 第 4 步：主机 B 将包含其 MAC 地址的 ARP 回复消息直接发送回主机 A。
* 第 5 步：当主机 A 收到从主机 B 发来的 ARP 回复消息时，会用主机 B 的 IP 和 MAC 地址映射更新 ARP 缓存。本机缓存是有生存期的，生存期结束后，将再次重复上面的过程。主机 B 的 MAC 地址一旦确定，主机 A 就能向主机 B 发送 IP 通信了。

# 问题
## 什么是 ARP 欺骗？
* 地址解析协议是建立在网络中各个主机可互相信任的基础上的，收到`应答报文`的主机，不会校验报文的真实性，就会加到 ARP 缓存中。
* 由此，攻击者可以向某一主机发送伪 ARP 应答报文，使此主机发送的信息无法到达预期的主机或者到达错误的主机，这就是 ARP 欺骗。



