如何阅读源码？
---

- 1. 确定要了解的主题。
- 2. 获取关键函数名称。
- 3. 打印调用此函数的堆栈 —— 关键路径。

这里主要介绍进行第三点的方法。

# BPF（C 语言）

```bash
# TODO
# sudo bpftrace -e 'uprobe:/home/zjc/hello_world:hello {printf("%s\n", ustack());}'
```

# SystemTap（C 语言）

> trace.stap

```bash
# TODO
probe process("/home/xxx/.local/openresty/nginx/sbin/nginx").function("ngx_http_*") {
    printf("%s -> %s\n", thread_indent(4), probefunc());
}

probe process("/home/xxx/.local/openresty/nginx/sbin/nginx").function("ngx_http_*").return {
    printf("%s <- %s\n", thread_indent(-4), probefunc());
}
```

执行

```
sudo stap trace.stap -x PROCESS_ID -v
```

# GDB

参考 [GDB](B.操作系统/Linux/Commands/gdb.md) 的 “跟踪实例” 部分。
