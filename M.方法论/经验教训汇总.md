# 编程、设计经验教训汇总

1. 接口设计、界面设计**不要**取巧，可以省略的字段也不用省略，例如不要通过字段有无来控制开关，应该用明确的字段来控制开关。**数据与控制分离。**
2. 主体程序与周边程序的接口**要**保持一致。例如，设计后端服务的 SDK 时，SDK 接口的参数名称、参数格式、函数名称等，应该与后端服务的接口保持一致。不一致的设计容易引入不易发现的问题，增加维护和使用成本。
3. 后端接口的数据结构**要**与界面展示的一致，例如，**不要**通过判断字段存在与否来控制开关是否开启，应该使用 enable/disable 字段明确指定。（和 1 中表达一样的意思）
4. 业务逻辑**不要**依赖底层数据库特性，方便切换数据库，同时避免问题，有底层依赖遇到问题时通常不好修复。例如配置版本号不要依赖数据库 sequence。
5. 接口、界面设计，凡是获取列表的，都**应**考虑分页问题，除非明确相关数据数量级别，否则都应该分页。
6. 配置同步中的全量同步**不要**依赖于版本号，应该保证全量数据正确，然后下发最新的版本号。
7. 配置同步时，是进行全量同步还是增量同步，应该由管理/生产端全权控制，数据/消费端只上报自身数据情况。
8. 数据与实现逻辑**要**一致（保持统一、简化）。例如某产品使用 LMDB 存储数据，不同的 LMDB 数据库中存储不同的配置，进行配置清理时，应该区分 LMDB 数据库，以使每个 LMDB 数据库中都有符合要求的数据，不要造成部分 LMDB 数据库中有数据，部分 LMDB 数据库中没有数据的情况。
9. “重试”等需要重复进行的逻辑，**务必**考虑进行次数限制以及考虑重复处理的时间间隔（例如时间间隔递增），避免无条件无限重试。
10. 自动生成的代码/文件，应该与人为生成的放到不同的目录进行区分，避免混到一起，方便过滤。
