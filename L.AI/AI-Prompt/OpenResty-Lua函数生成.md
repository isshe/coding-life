请帮我生成一个 OpenResty Lua 函数，要求如下：

**函数基本信息：**
- 函数名称：[FUNCTION_NAME]
- 函数功能：[FUNCTION_DESCRIPTION]
- 调用场景：[WHEN_TO_USE]

**技术规范：**
- 使用 OpenResty/ngx_lua 环境
- 函数定义格式：`local function function_name(params) end`
- 如需导出：`_M.function_name = function_name`，导出函数放在定义之后，不要放文件最后
- 代码注释使用英文
- 包含参数验证
- 包含错误处理，返回 `result, error_message` 格式
- 使用 `ngx.log` 记录关键操作日志

**函数签名：**
- 输入参数：[详细描述每个参数的类型和含义]
- 返回值：[描述返回值的格式和含义]
- 错误处理：[描述可能的错误情况]

**业务逻辑：**
[详细描述函数需要实现的具体逻辑步骤]

**数据库操作（如需要）：**
- 数据库类型：[PostgreSQL/Redis/LMDB等]
- 查询需求：[具体的查询逻辑]
- 表结构：[相关的表结构信息]

**外部调用（如需要）：**
- API 端点：[需要调用的外部 API]
- 请求格式：[请求参数和格式]
- 响应处理：[如何处理响应数据]

**性能要求：**
- 响应时间：[性能要求]
- 并发处理：[并发要求]
- 资源使用：[内存、CPU 等要求]

**使用示例：**
请提供函数的调用示例，包括：
- 正常调用示例
- 错误处理示例
- 边界情况处理

**相关上下文：**
[提供相关的代码上下文、数据结构定义、或其他相关信息]
