[TOC]

ARP协议
---

ARP（Address Resolution Protocol）：地址解析协议，是根据IP地址获取物理地址的一个TCP/IP协议。

# 工作过程
当主机A要与主机B通信时，地址解析协议可以将主机B的IP地址解析成主机B的MAC地址(如果A/B不同网段，则A解析的应该是下一跳的MAC地址)，以下为工作流程：
* 第1步：主机A根据路由表内容，确定用于访问主机B的转发IP地址。主机A在本地ARP缓存中查找与主机B的IP匹配MAC地址。
* 第2步：如果主机A没有找到映射，则将ARP请求帧广播到本地网络上的所有主机。
    * 收到请求的主机检查自己的IP是否匹配，不匹配就丢弃此ARP请求。
* 第3步：主机B确定ARP请求中的IP地址与自己的IP地址匹配，则将主机A的IP地址和MAC地址映射添加到本地ARP缓存中。
* 第4步：主机B将包含其MAC地址的ARP回复消息直接发送回主机A。
* 第5步：当主机A收到从主机B发来的ARP回复消息时，会用主机B的IP和MAC地址映射更新ARP缓存。本机缓存是有生存期的，生存期结束后，将再次重复上面的过程。主机B的MAC地址一旦确定，主机A就能向主机B发送IP通信了。

# 问题
## 什么是ARP欺骗？
* 地址解析协议是建立在网络中各个主机可互相信任的基础上的，收到`应答报文`的主机，不会校验报文的真实性，就会加到ARP缓存中。
* 由此，攻击者可以向某一主机发送伪ARP应答报文，使此主机发送的信息无法到达预期的主机或者到达错误的主机，这就是ARP欺骗。



